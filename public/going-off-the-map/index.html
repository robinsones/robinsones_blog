<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.51 with theme Tranquilpeak 0.4.3-SNAPSHOT">
<meta name="author" content="Emily Robinson">
<meta name="keywords" content="">
<meta name="description" content="I recently completed Colin Fay’s excellent DataCamp course, Intermediate Functional Programming with purrr (full disclosure: I work at DataCamp, but part of why I joined was that I was a big fan of the short, interactive course format). Although I’ve used the purrr package before, there were a lot of functions in this course that were new to me. I wrote this post to hopefully demystify purrr a bit for those who find it overwhelming and illustrate some of its lesser known functions.">


<meta property="og:description" content="I recently completed Colin Fay’s excellent DataCamp course, Intermediate Functional Programming with purrr (full disclosure: I work at DataCamp, but part of why I joined was that I was a big fan of the short, interactive course format). Although I’ve used the purrr package before, there were a lot of functions in this course that were new to me. I wrote this post to hopefully demystify purrr a bit for those who find it overwhelming and illustrate some of its lesser known functions.">
<meta property="og:type" content="article">
<meta property="og:title" content="Going Off the Map: Exploring purrr&#39;s Other Functions">
<meta name="twitter:title" content="Going Off the Map: Exploring purrr&#39;s Other Functions">
<meta property="og:url" content="/going-off-the-map/">
<meta property="twitter:url" content="/going-off-the-map/">
<meta property="og:site_name" content="Hooked on Data">
<meta property="og:description" content="I recently completed Colin Fay’s excellent DataCamp course, Intermediate Functional Programming with purrr (full disclosure: I work at DataCamp, but part of why I joined was that I was a big fan of the short, interactive course format). Although I’ve used the purrr package before, there were a lot of functions in this course that were new to me. I wrote this post to hopefully demystify purrr a bit for those who find it overwhelming and illustrate some of its lesser known functions.">
<meta name="twitter:description" content="I recently completed Colin Fay’s excellent DataCamp course, Intermediate Functional Programming with purrr (full disclosure: I work at DataCamp, but part of why I joined was that I was a big fan of the short, interactive course format). Although I’ve used the purrr package before, there were a lot of functions in this course that were new to me. I wrote this post to hopefully demystify purrr a bit for those who find it overwhelming and illustrate some of its lesser known functions.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2019-01-09T00:00:00">
  
  
    <meta property="article:modified_time" content="2019-01-09T00:00:00">
  
  
  
  
    
      <meta property="article:tag" content="R">
    
      <meta property="article:tag" content="Code">
    
      <meta property="article:tag" content="tidyverse">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@robinson_es">


  <meta name="twitter:creator" content="@robinson_es">










  <meta property="og:image" content="https://avatars.githubusercontent.com/robinsones">
  <meta property="twitter:image" content="https://avatars.githubusercontent.com/robinsones">


    <title>Going Off the Map: Exploring purrr&#39;s Other Functions</title>

    <link rel="icon" href="/favicon.png">
    

    

    <link rel="canonical" href="/going-off-the-map/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="/css/style-nnm2spxvve8onlujjlegkkytaehyadd4ksxc1hyzzq9a2wvtrgbljqyulomn.min.css" />
    
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-80069806-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="/">Hooked on Data</a>
  </div>
  
    
      <a class="header-right-picture "
         href="/about">
    
    
    
      
        <img class="header-picture" src="https://avatars.githubusercontent.com/robinsones" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="/about">
          <img class="sidebar-profile-picture" src="https://avatars.githubusercontent.com/robinsones" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Emily Robinson</h4>
        
          <h5 class="sidebar-profile-bio">Date Scientist at DataCamp</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.linkedin.com/in/robinsones/">
    
      <i class="sidebar-button-icon fa fa-lg fa-linkedin"></i>
      
      <span class="sidebar-button-desc">Linkedin</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/robinsones">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/speaking">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">Speaking</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="5"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Going Off the Map: Exploring purrr&#39;s Other Functions
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2019-01-09T00:00:00Z">
        
  January 9, 2019

      </time>
    
    
  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              


<p>I recently completed <a href="https://colinfay.me/">Colin Fay’s</a> excellent DataCamp course, <a href="https://www.datacamp.com/courses/intermediate-functional-programming-with-purrr">Intermediate Functional Programming with purrr</a> (full disclosure: I work at DataCamp, but part of why I joined was that I was a big fan of the short, interactive course format). Although I’ve used the <code>purrr</code> package before, there were a lot of functions in this course that were new to me. I wrote this post to hopefully demystify <code>purrr</code> a bit for those who find it overwhelming and illustrate some of its lesser known functions. Most of these functions are covered in Colin’s course, though I added a few I found on the <a href="https://www.rstudio.com/resources/cheatsheets/#purrr"><code>purrr</code> cheatsheet</a>.</p>
<div id="jump-to" class="section level2">
<h2>Jump to:</h2>
<ol style="list-style-type: decimal">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#a-brief-introduction-to-map">A brief introduction to map()</a></li>
<li><a href="#beyond-map">Beyond map()</a>
<ol style="list-style-type: decimal">
<li><a href="#modifying-and-summarizing-vectors/lists">Modifying and summarizing vectors/lists</a>
<ol style="list-style-type: decimal">
<li><a href="#keep-and-discard">keep() and discard()</a></li>
<li><a href="#map_if">map_if()</a></li>
<li><a href="#every-and-some">every() and some()</a></li>
</ol></li>
<li><a href="#modifying-functions">Modifying functions</a>
<ol style="list-style-type: decimal">
<li><a href="#negate">negate()</a></li>
<li><a href="#partial">partial()</a></li>
<li><a href="#safely-and-possibly">safely() and possibly()</a></li>
<li><a href="#compact">compact()</a></li>
<li><a href="#compose">compose()</a></li>
</ol></li>
</ol></li>
</ol>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><code>purrr</code> is a package for functional programming in R. If you’re familiar with it, it’s probably because of the <code>map()*</code> functions. And if you’ve been a little bit intimidated by them, I’m right there with you. You’ll often see <code>purrr</code> used with nested lists or dataframes, like in this (modified) example from one of the last lessons in Jenny Bryan’s <code>purrr</code> tutorial:</p>
<pre class="r"><code>library(dplyr)
library(purrr)
library(gapminder)
library(tidyr)</code></pre>
<pre class="r"><code>gapminder %&gt;%
  group_by(country) %&gt;%
  nest() %&gt;%  
  mutate(fit = map(data, ~ lm(lifeExp ~ year, data = .x))) %&gt;%
  mutate(rsq = map_dbl(fit, ~ summary(.x)[[&quot;r.squared&quot;]])) %&gt;%
  arrange(rsq)</code></pre>
<pre><code>## # A tibble: 142 x 4
##    country          data              fit         rsq
##    &lt;fct&gt;            &lt;list&gt;            &lt;list&gt;    &lt;dbl&gt;
##  1 Rwanda           &lt;tibble [12 × 5]&gt; &lt;S3: lm&gt; 0.0172
##  2 Botswana         &lt;tibble [12 × 5]&gt; &lt;S3: lm&gt; 0.0340
##  3 Zimbabwe         &lt;tibble [12 × 5]&gt; &lt;S3: lm&gt; 0.0562
##  4 Zambia           &lt;tibble [12 × 5]&gt; &lt;S3: lm&gt; 0.0598
##  5 Swaziland        &lt;tibble [12 × 5]&gt; &lt;S3: lm&gt; 0.0682
##  6 Lesotho          &lt;tibble [12 × 5]&gt; &lt;S3: lm&gt; 0.0849
##  7 Cote d&#39;Ivoire    &lt;tibble [12 × 5]&gt; &lt;S3: lm&gt; 0.283 
##  8 South Africa     &lt;tibble [12 × 5]&gt; &lt;S3: lm&gt; 0.312 
##  9 Uganda           &lt;tibble [12 × 5]&gt; &lt;S3: lm&gt; 0.342 
## 10 Congo, Dem. Rep. &lt;tibble [12 × 5]&gt; &lt;S3: lm&gt; 0.348 
## # … with 132 more rows</code></pre>
<p>If you’ve generally worked with plain-old table data or vectors (like I have), you might have this reaction to that code:</p>
<div class="figure">
<img src="https://media.giphy.com/media/a93jwI0wkWTQs/giphy.gif" />

</div>
<p>But I am here to tell you: <code>purrr</code> can make your life easier even if you never write code like this. Certainly, knowing how to work with complicated nested lists and dataframes is very useful - it can simplify code you’ve written, and your data may arrive in that format (for example, JSON data is often represented as nested lists or dataframes in R). But even if all you ever work with is “simple” lists, dataframes, and vectors, you’ll be glad to know a bit of <code>purrr</code>.</p>
</div>
<div id="a-brief-introduction-to-map" class="section level2">
<h2>A brief introduction to map()</h2>
<p><code>map()</code> lets you take a list or vector and apply a function to each element. If you’ve been using R for a while, you might be familiar with the apply functions, including <code>sapply()</code> and <code>lapply()</code>. <code>map()</code> does essentially the same thing, but offers several advantages, most importantly consistency of output and helpers that let you write more concise code (see the first Stack Overflow answer by Hadley Wickham <a href="https://stackoverflow.com/questions/45101045/why-use-purrrmap-instead-of-lapply">here</a>).</p>
<p>Let’s look at an example, where we take a list of four numbers and round each of them.</p>
<pre class="r"><code>my_vector &lt;- c(1.0212, 2.483, 3.189, 4.5938)

map(my_vector, round)</code></pre>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 2
## 
## [[3]]
## [1] 3
## 
## [[4]]
## [1] 5</code></pre>
<p>The result is a list (hence the double brackets), which is always the case with <code>map()</code>. But you can return a dataframe or different types of vectors instead by using the appropriate <code>map_*()</code> function. In this case, let’s return a vector of type <code>double</code><a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>:</p>
<pre class="r"><code>map_dbl(my_vector, round)</code></pre>
<pre><code>## [1] 1 2 3 5</code></pre>
<p>You can also use <code>map</code> with an “anonymous” function, a function that doesn’t have a name. The formula is a <code>~</code> followed by what you want to do to each element, with <code>.x</code> representing the element (<code>.</code> also works). We can make an anonymous function to add ten to each element of our vector:</p>
<pre class="r"><code>map_dbl(my_vector, ~ .x + 10)</code></pre>
<pre><code>## [1] 11.0212 12.4830 13.1890 14.5938</code></pre>
<p><code>map()</code> can get much (much) more complicated, with nested lists and multiple inputs and arguments, but even knowing this basic use case can help you! If you do want to dive in more, check out <a href="https://r4ds.had.co.nz/iteration.html#the-map-functions">chapter 21 of R for Data Science</a>, Jenny Bryan’s <a href="https://jennybc.github.io/purrr-tutorial/">purrr tutorials</a>, Auriel Fournier’s <a href="https://www.datacamp.com/courses/foundations-of-functional-programming-with-purrr">Foundations of Functional Programming with purrr</a> course, and chapters 3 and 4 of <a href="https://www.datacamp.com/courses/writing-functions-in-r">Writing Functions in R</a> by Charlotte and Hadley Wickham on DataCamp.</p>
</div>
<div id="beyond-map" class="section level2">
<h2>Beyond map()</h2>
<p>While <code>map*()</code> is great, it can still take a while to wrap your head around. But <code>purrr</code> offers dozens of useful functions that you can start using right away to streamline your workflow, even if you don’t use <code>map()</code>. Let’s check out a few. I’ll separate them into two types: those that create new functions and those that modify a list/vector.</p>
<div id="modifying-and-summarizing-vectorslists" class="section level3">
<h3>Modifying and summarizing vectors/lists</h3>
<div id="keep-and-discard" class="section level4">
<h4>keep() and discard()</h4>
<p><code>keep()</code> and <code>discard()</code> … keep and discard elements of a list or vector based on a <em>predicate function</em>. A predicate function is a function that returns <code>TRUE</code> or <code>FALSE</code>. So <code>is.factor()</code> is a predicate function, because it always returns <code>TRUE</code> or <code>FALSE</code>, while <code>round()</code> is not.</p>
<p>For example, we can <code>keep()</code> all elements of our list that are less than 3 with the following code:</p>
<pre class="r"><code>keep(my_vector, ~ .x &lt; 3)</code></pre>
<pre><code>## [1] 1.0212 2.4830</code></pre>
<p>Similarly, we could <code>discard()</code> all elements less than 3:</p>
<pre class="r"><code>discard(my_vector, ~ .x &lt; 3)</code></pre>
<pre><code>## [1] 3.1890 4.5938</code></pre>
</div>
<div id="map_if" class="section level4">
<h4>map_if()</h4>
<p>What if you’re not sure about the types of every element in your list, and you want to apply a function that needs the input to be of a certain type? For example, let’s say we wanted to add 10 to every element of a list.</p>
<pre class="r"><code>mixed_list &lt;- list(&quot;happy&quot;, 2L, 4.39)

add_ten &lt;- function(n) {
  n + 10
}</code></pre>
<pre class="r"><code>map(mixed_list, add_ten)</code></pre>
<pre><code>## Error in n + 10: non-numeric argument to binary operator</code></pre>
<p>We get an error since we’re trying to add 10 to “happy”, which isn’t numeric!</p>
<p>This is where <code>map_if()</code> comes in handy. Just like <code>mutate_if()</code>, <code>select_if()</code>, and <code>summarise_if()</code>, you add a condition and the function will only apply to those columns (or list elements) where the condition is met. Here, we know that condition is that the element needs to be numeric. Let’s try again with <code>map_if()</code>:</p>
<pre class="r"><code>map_if(mixed_list, is.numeric, add_ten)</code></pre>
<pre><code>## [[1]]
## [1] &quot;happy&quot;
## 
## [[2]]
## [1] 12
## 
## [[3]]
## [1] 14.39</code></pre>
<p>Alright! We see it skipped over “happy”, preserving it as is, and added ten to the two numeric elements.</p>
</div>
<div id="every-and-some" class="section level4">
<h4>every() and some()</h4>
<p>Sometimes you have a giant list and want to know whether each element meets a condition, like being numeric. You can use <code>every()</code>, which will check if every element of a list satisfies a predicate function:</p>
<pre class="r"><code>every(mixed_list, is.numeric)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<p>Since “happy” is the first element of <code>mixed_list</code>, it doesn’t past the test.</p>
<p>If we want to be less strict and just check if <strong>some</strong> of the elements satisfies a predicate function, we can use <code>some()</code> instead:</p>
<pre class="r"><code>some(mixed_list, is.numeric)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>In this case, since some elements of <code>mixed_list</code> were numeric, we got <code>TRUE</code>.</p>
</div>
</div>
<div id="modifying-functions" class="section level3">
<h3>Modifying functions</h3>
<p><code>purrr</code> includes <strong>adverbs</strong> - functions that take a function and return a modified version (just as an adverb modifies a verb). Let’s check out a few!</p>
<div id="negate" class="section level4">
<h4>negate()</h4>
<p><code>negate()</code> … negates a predicate function (aren’t the <code>purrr</code> function names great?). For example, let’s say you want to check which elements of a list were not null. This is how you would do it with <code>map_lgl</code> (which returns a logical vector rather than a list):</p>
<pre class="r"><code>lst &lt;- list(&quot;a&quot;, 3, 22, NULL, &quot;q&quot;, NULL)</code></pre>
<pre class="r"><code>map_lgl(lst, ~ !is.null(.))</code></pre>
<pre><code>## [1]  TRUE  TRUE  TRUE FALSE  TRUE FALSE</code></pre>
<p>This works, but it’s not super easy to read. Instead, we can make an <code>is_not_null()</code> function using <code>negate()</code>:</p>
<pre class="r"><code>is_not_null &lt;- negate(is.null)

map_lgl(lst, is_not_null)</code></pre>
<pre><code>## [1]  TRUE  TRUE  TRUE FALSE  TRUE FALSE</code></pre>
<p>Voila!</p>
</div>
<div id="partial" class="section level4">
<h4>partial()</h4>
<p>You probably have a couple functions where you almost always use an extra argument, like <code>mean()</code> with <code>na.rm = TRUE</code> or <code>round()</code> with <code>digits = 1</code>. You can use <code>partial()</code> to create a new function where those are always specified, saving you some repetitive typing!</p>
<pre class="r"><code>mean(c(10, NA, 5, 7))</code></pre>
<pre><code>## [1] NA</code></pre>
<pre class="r"><code>mean(c(10, NA, 5, 7), na.rm = TRUE)</code></pre>
<pre><code>## [1] 7.333333</code></pre>
<pre class="r"><code>my_mean &lt;- partial(mean, na.rm = TRUE)

my_mean(c(10, NA, 5, 7))</code></pre>
<pre><code>## [1] 7.333333</code></pre>
<pre class="r"><code>my_round &lt;- partial(round, digits = 1)

my_round(10.484)</code></pre>
<pre><code>## [1] 10.5</code></pre>
</div>
<div id="safely-and-possibly" class="section level4">
<h4>safely() and possibly()</h4>
<p>We saw earlier that <code>map_if()</code> could be used where we have a condition we want to be met before applying a function. In our case, we used it to avoid an error, but you could also use it to meet a condition like the number being negative or greater than a threshold. But what if you don’t know where errors could come from but want to handle them? This is where <code>safely()</code> and <code>possibly()</code> come in.</p>
<p>If you’re not interested in what the error is, you should use <code>possibly()</code>. In addition to the function it’s wrapping around, you need to specify the argument <code>otherwise</code>, which is what you want to return if there is an error. Let’s take a look:</p>
<pre class="r"><code>possibly_add_ten &lt;- possibly(add_ten, otherwise = &quot;I&#39;m not numeric!&quot;)

map(mixed_list, possibly_add_ten)</code></pre>
<pre><code>## [[1]]
## [1] &quot;I&#39;m not numeric!&quot;
## 
## [[2]]
## [1] 12
## 
## [[3]]
## [1] 14.39</code></pre>
<p>Side-note - I find the the double-brackets confusing. We’ve got them since our list isn’t named. Let’s set the name of each element with <code>purrr's</code> <code>set_names()</code>, giving our elements the very creative names <code>a</code>, <code>b</code>, and <code>c</code>.</p>
<pre class="r"><code>mixed_list &lt;- set_names(mixed_list, c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;))

mixed_list</code></pre>
<pre><code>## $a
## [1] &quot;happy&quot;
## 
## $b
## [1] 2
## 
## $c
## [1] 4.39</code></pre>
<p>Well … mildly easier to read at least.</p>
<p>On the other hand, sometimes you do want to know what the error is. If that’s the case, you can use <code>safely()</code> instead:</p>
<pre class="r"><code>map(mixed_list, safely(add_ten))</code></pre>
<pre><code>## $a
## $a$result
## NULL
## 
## $a$error
## &lt;simpleError in n + 10: non-numeric argument to binary operator&gt;
## 
## 
## $b
## $b$result
## [1] 12
## 
## $b$error
## NULL
## 
## 
## $c
## $c$result
## [1] 14.39
## 
## $c$error
## NULL</code></pre>
<p><code>safely()</code> returns a list of lists. Each element from the original list has two entries: <code>result</code> and <code>error</code>. One is always <code>NULL</code> - if there was an error, <code>result</code> is <code>NULL</code> and <code>error</code> is the error message; if there wasn’t an error, the <code>result</code> is the result and <code>error</code> is <code>NULL</code>. If you want to get back all the errors or results, you can use another handy feature of <code>map()</code>. If you give <code>map()</code> a string as the second argument, for each element of the list, it will return the element inside of it with that name.</p>
<pre class="r"><code>safely_add_ten &lt;- safely(add_ten)

mixed_list %&gt;%
  map(safely_add_ten) %&gt;%
  map(&quot;error&quot;)</code></pre>
<pre><code>## $a
## &lt;simpleError in n + 10: non-numeric argument to binary operator&gt;
## 
## $b
## NULL
## 
## $c
## NULL</code></pre>
<p>Ah, no more list of lists. That was scary. I promise I won’t do it again.</p>
</div>
<div id="compact" class="section level4">
<h4>compact()</h4>
<p>In the previous example, we probably wouldn’t be interested in the instances where errors were <code>NULL</code>. We could use <code>discard(is.null)</code>, but <code>purrr</code> actually provides a function just for the purpose of getting rid of <code>NULL</code>s: <code>compact()</code>.</p>
<pre class="r"><code>mixed_list %&gt;%
  map(safely_add_ten) %&gt;%
  map(&quot;error&quot;) %&gt;%
  compact()</code></pre>
<pre><code>## $a
## &lt;simpleError in n + 10: non-numeric argument to binary operator&gt;</code></pre>
</div>
<div id="compose" class="section level4">
<h4>compose()</h4>
<p><code>compose()</code> lets you string together multiple functions. Let’s say you want to <code>add_ten()</code>, take the log, and then round a vector of numbers. You could do either of these:</p>
<pre class="r"><code>c(1, 20, 500) %&gt;%
  add_ten() %&gt;%
  log() %&gt;%
  round()</code></pre>
<pre><code>## [1] 2 3 6</code></pre>
<pre class="r"><code>round(log(add_ten(c(1, 20, 500))))</code></pre>
<pre><code>## [1] 2 3 6</code></pre>
<p>But you could also make a new function using <code>compose()</code>. You give <code>compose()</code> functions to execute in order from <em>right to left</em> (just like we have written above):</p>
<pre class="r"><code>add_ten_log_and_round &lt;- compose(round, log, add_ten)

add_ten_log_and_round(c(1, 20, 500))</code></pre>
<pre><code>## [1] 2 3 6</code></pre>
<p><code>compose()</code> is great for simplifying your code if you’re going to use a sequence of functions again and again.</p>
<p>What if we wanted to round to the nearest tenth instead? You can combine <code>compose()</code> with <code>partial()</code>!</p>
<pre class="r"><code>round_tenth &lt;- partial(round, digits = 1)

add_ten_log_and_round_tenth &lt;- compose(round_tenth, log, add_ten)

add_ten_log_and_round_tenth(c(1, 20, 500))</code></pre>
<pre><code>## [1] 2.4 3.4 6.2</code></pre>
</div>
</div>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>There’s so much to learn in the wonderful world of <code>purrr</code>! I’m a big believer that just knowing something exists gets you a lot of the way there. Maybe you can’t think of a use for <code>partial()</code> right now, but you’ll run into a problem a few months down the line where it would be handy. You don’t need to remember the exact syntax; all you need to know is what to Google for and that you don’t need to spend hours trying to find some other solution or resign yourself to writing repetitive code.</p>
<p>One thing I didn’t show in this post was how all of these functions can fit together in an analysis. For that, I’ll recommend <a href="(https://www.datacamp.com/courses/intermediate-functional-programming-with-purrr)">Colin’s course</a> again. He also has a series of six blog posts illustrating different <code>purrr</code> functions, including some I didn’t cover here; <a href="https://colinfay.me/tags/#purrr">check them out</a>!</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Now, this is a bit of a silly example. Because <code>round()</code> is vectorized (it works not just on a single value but a vector of them), you could have just done this instead:</p>
<pre class="r"><code>round(my_vector)</code></pre>
<pre><code>## [1] 1 2 3 5</code></pre>
<p>This won’t work, however, if your input is a list instead of a vector:</p>
<pre class="r"><code>vec_as_list &lt;- list(my_vector)

round(vec_as_list)</code></pre>
<pre><code>## Error in round(vec_as_list): non-numeric argument to mathematical function</code></pre>
<p>But <code>map()</code> still will:</p>
<pre class="r"><code>map(vec_as_list, round)</code></pre>
<pre><code>## [[1]]
## [1] 1 2 3 5</code></pre>
<p>Generally, you don’t need <code>map</code> when you’re working with a simple vector and a vectorized function. <code>map</code> shines where you either a) have a non-vectorized function or b) a more complicated data structure (including a list).<a href="#fnref1">↩</a></p></li>
</ol>
</div>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="/tags/r/">R</a>

  <a class="tag tag--primary tag--small" href="/tags/code/">Code</a>

  <a class="tag tag--primary tag--small" href="/tags/tidyverse/">tidyverse</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/introducing-the-funneljoin-package/" data-tooltip="Introducing the funneljoin package">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/the-lesser-known-stars-of-the-tidyverse/" data-tooltip="The Lesser Known Stars of the Tidyverse">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/going-off-the-map/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/going-off-the-map/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2019 Emily Robinson. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/introducing-the-funneljoin-package/" data-tooltip="Introducing the funneljoin package">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/the-lesser-known-stars-of-the-tidyverse/" data-tooltip="The Lesser Known Stars of the Tidyverse">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/going-off-the-map/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/going-off-the-map/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="5">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=%2Fgoing-off-the-map%2F">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=%2Fgoing-off-the-map%2F">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://avatars.githubusercontent.com/robinsones" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Emily Robinson</h4>
    
      <div id="about-card-bio">Date Scientist at DataCamp</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Data Scientist
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        New York
      </div>
    
  </div>
</div>

    <div id="algolia-search-modal" class="modal-container">
  <div class="modal">
    <div class="modal-header">
      <span class="close-button"><i class="fa fa-close"></i></span>
      <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
        <span class="searchby-algolia-text text-color-light text-small">by</span>
        <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
      </a>
      <i class="search-icon fa fa-search"></i>
      <form id="algolia-search-form">
        <input type="text" id="algolia-search-input" name="search"
          class="form-control input--large search-input" placeholder="Search" />
      </form>
    </div>
    <div class="modal-body">
      <div class="no-result text-color-light text-center">no post found</div>
      <div class="results">
        
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/pok%C3%A9mon-type-combinations/">
                <h3 class="media-heading">Using R to Find the Best Combinations of Pokemon Types</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Aug 8, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">I recently started playing Pokémon again - “Pokémon Let’s Go Eevee” on the Nintendo Switch to be specific. In the classic pokémon games, you have a team of 6 pokémon that you use to battle against other trainers. In battles, type match-ups are very important, as some types of moves are “super effective” against other types. For example, fire moves are super effective against grass pokémon, which means they do double the damage they normally would.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/exploring-bob-ross-paintings/">
                <h3 class="media-heading">Exploring Bob Ross paintings</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Aug 8, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">In this post, I try something new and share an analysis I did without stopping to explain the code along the way (with a few exceptions). I analyze a dataset on Bob Ross paintings from last week’s Tidytuesday, an initiative by the R for Data Science online learning community. Each Monday, a new dataset is posted on GitHub with a short description. You can see some analyses and visualizations people have done by searching for the #tidytuesday hashtag on Twitter.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/introducing-the-funneljoin-package/">
                <h3 class="media-heading">Introducing the funneljoin package</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Aug 8, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Have you ever had a “first this then that” question? For example, maybe you’re an e-commerce business and you want all the times people clicked on an item and then added it to their cart within 2 days, or the last page they visited before registering. Or you work with pharmaceutical data and need to know what drugs people took before drug x and which drugs they took afterward and when.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/going-off-the-map/">
                <h3 class="media-heading">Going Off the Map: Exploring purrr&#39;s Other Functions</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jan 1, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">I recently completed Colin Fay’s excellent DataCamp course, Intermediate Functional Programming with purrr (full disclosure: I work at DataCamp, but part of why I joined was that I was a big fan of the short, interactive course format). Although I’ve used the purrr package before, there were a lot of functions in this course that were new to me. I wrote this post to hopefully demystify purrr a bit for those who find it overwhelming and illustrate some of its lesser known functions.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/the-lesser-known-stars-of-the-tidyverse/">
                <h3 class="media-heading">The Lesser Known Stars of the Tidyverse</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Nov 11, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">In early 2018, I gave a few conference talks on “The Lesser Known Stars of the Tidyverse.” I focused on some packages and functions that aren’t as well known as the core parts of ggplot2 and dplyr but are very helpful in exploratory analysis. I walked through an example analysis of Kaggle’s 2017 State of Data Science and Machine Learning Survey to show how I would use these functions in an exploratory analysis.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/guidelines-for-ab-testing/">
                <h3 class="media-heading">Guidelines for A/B Testing</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Aug 8, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">When I was working at Etsy, I benefited from a very robust A/B testing system. Etsy had been doing A/B testing for more than 6 years. By the time I left, Etsy’s in-house experimentation system, called Catapult, had more than 5 data engineers working on it full-time. Every morning, I was greeted with a homepage that listed all the experiments that Etsy had run in the prior four years. When you clicked on one, you got a summary of what the experiment was testing (usually written by the product manager).</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/red-flags-in-data-science-interviews/">
                <h3 class="media-heading">Red Flags in Data Science Interviews</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jul 7, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">This post was co-written with Jacqueline Nolis, Principal at Nolis, LLC. Check out the rest of her blog posts, including ones on prioritizing data science work, hiring data scientists, and what to do when your data science project isn’t working.
When interviewing for any position, you should be evaluating the company just as much as they are evaluating you. While you can research the company beforehand on glassdoor and similar sites, interviews are the best place to get a deeper understanding of the company and ask important questions.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/advice-for-applying-to-data-science-jobs/">
                <h3 class="media-heading">Advice for Applying to Data Science Jobs</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  May 5, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Following Dave Robinson’s sage tweet to write a blog post when you’ve given the same advice three times, this post is a collection of my thoughts and recommendations for people interested in applying to data science jobs in the US. Many of these principles also apply to tech jobs in general.
A disclaimer: I have never worked as a recruiter or career coach. This knowledge comes from mainly from my study of Organizational Behavior (including negotiations and women in tech) in graduate school and my own career.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/the-importance-of-sponsorship/">
                <h3 class="media-heading">The Importance of Sponsorship</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Feb 2, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">In my last post, I discussed the importance of building your network and some strategies for effectively reaching out. I closed with emphasizing how helpful your peers or people one step ahead of you can be. But there’s a specific area where people with more resources, status, or experience can help you: sponsorship.
What is sponsorship? When people discuss what they’re seeking from a more senior person in their field, they usually talk about “mentorship.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/building-your-data-science-network-finding-community/">
                <h3 class="media-heading">Building Your Data Science Network: Finding Community</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jan 1, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">So you’ve heard you’re supposed to network. That’s the key in getting a job or establishing a reputation in your broader field, right? And it’s true that the importance of having a good network is supported by a lot of social sciences research. But if the thought of networking makes you cringe, you’re not alone. Many people equate networking to sending out millions of unsolicited Linkedin requests with no message, handing out 20 business cards at a meetup once a week, or sending emails to prominent data scientists with the subject line “Can I pick your brain?</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <p class="results-count text-medium"
         data-message-zero="no post found"
         data-message-one="1 post found"
         data-message-other="{n} posts found">
         20 posts found
      </p>
    </div>
  </div>
</div>
    
  
    
    <div id="cover" style="background-image:url('/images/cover.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="/js/script-qi9wbxp2ya2j6p7wx1i6tgavftewndznf4v0hy2gvivk1rxgc3lm7njqb6bz.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
  




    
  </body>
</html>

